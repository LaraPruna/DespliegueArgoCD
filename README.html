<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><style>body {
  max-width: 980px;
  border: 1px solid #ddd;
  outline: 1300px solid #fff;
  margin: 16px auto;
}

body .markdown-body
{
  padding: 45px;
}

@font-face {
  font-family: fontawesome-mini;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

.markdown-body {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #333333;
  overflow: hidden;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body b,
.markdown-body strong {
  font-weight: bold;
}

.markdown-body mark {
  background: #ff0;
  color: #000;
  font-style: italic;
  font-weight: bold;
}

.markdown-body sub,
.markdown-body sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
.markdown-body sup {
  top: -0.5em;
}
.markdown-body sub {
  bottom: -0.25em;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre,
.markdown-body samp {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body .codehilitetable,
.markdown-body .highlighttable {
  border: 0;
  border-spacing: 0;
}

.markdown-body .codehilitetable tr,
.markdown-body .highlighttable {
  border: 0;
}

.markdown-body .codehilitetable pre,
.markdown-body .codehilitetable div.codehilite,
.markdown-body .highlighttable pre,
.markdown-body .highlighttable div.highlight {
  margin: 0;
}

.markdown-body .linenos,
.markdown-body .code,
.markdown-body .codehilitetable td,
.markdown-body .highlighttable td {
  border: 0;
  padding: 0;
}

.markdown-body td:not(.linenos) .linenodiv {
  padding: 0 !important;
}

.markdown-body .code {
  width: 100%;
}

.markdown-body .linenos div pre,
.markdown-body .linenodiv pre,
.markdown-body .linenodiv {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-left-radius: 3px;
  -webkit-border-bottom-left-radius: 3px;
  -moz-border-radius-topleft: 3px;
  -moz-border-radius-bottomleft: 3px;
  border-top-left-radius: 3px;
  border-bottom-left-radius: 3px;
}

.markdown-body .code div pre,
.markdown-body .code div {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-right-radius: 3px;
  -webkit-border-bottom-right-radius: 3px;
  -moz-border-radius-topright: 3px;
  -moz-border-radius-bottomright: 3px;
  border-top-right-radius: 3px;
  border-bottom-right-radius: 3px;
}

.markdown-body * {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body input {
  font: 13px Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
  line-height: 1.4;
}

.markdown-body a {
  color: #4183c4;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:focus,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before,
.markdown-body hr:after {
  display: table;
  content: " ";
}

.markdown-body hr:after {
  clear: both;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre,
.markdown-body samp {
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #e7e7e7;
  background-image: -moz-linear-gradient(#fefefe, #e7e7e7);
  background-image: -webkit-linear-gradient(#fefefe, #e7e7e7);
  background-image: linear-gradient(#fefefe, #e7e7e7);
  background-repeat: repeat-x;
  border-radius: 2px;
  border: 1px solid #cfcfcf;
  color: #000;
  padding: 3px 5px;
  line-height: 10px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  display: inline-block;
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body .headerlink {
  font: normal 400 16px fontawesome-mini;
  vertical-align: middle;
  margin-left: -16px;
  float: left;
  display: inline-block;
  text-decoration: none;
  opacity: 0;
  color: #333;
}

.markdown-body .headerlink:focus {
  outline: none;
}

.markdown-body h1 .headerlink {
  margin-top: 0.8rem;
}

.markdown-body h2 .headerlink,
.markdown-body h3 .headerlink {
  margin-top: 0.6rem;
}

.markdown-body h4 .headerlink {
  margin-top: 0.2rem;
}

.markdown-body h5 .headerlink,
.markdown-body h6 .headerlink {
  margin-top: 0;
}

.markdown-body .headerlink:hover,
.markdown-body h1:hover .headerlink,
.markdown-body h2:hover .headerlink,
.markdown-body h3:hover .headerlink,
.markdown-body h4:hover .headerlink,
.markdown-body h5:hover .headerlink,
.markdown-body h6:hover .headerlink {
  opacity: 1;
  text-decoration: none;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre,
.markdown-body .admonition {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body code,
.markdown-body samp {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .codehilite,
.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .codehilite pre,
.markdown-body .highlight pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .codehilite pre,
.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

/* Admonition */
.markdown-body .admonition {
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  position: relative;
  border-radius: 3px;
  border: 1px solid #e0e0e0;
  border-left: 6px solid #333;
  padding: 10px 10px 10px 30px;
}

.markdown-body .admonition table {
  color: #333;
}

.markdown-body .admonition p {
  padding: 0;
}

.markdown-body .admonition-title {
  font-weight: bold;
  margin: 0;
}

.markdown-body .admonition>.admonition-title {
  color: #333;
}

.markdown-body .attention>.admonition-title {
  color: #a6d796;
}

.markdown-body .caution>.admonition-title {
  color: #d7a796;
}

.markdown-body .hint>.admonition-title {
  color: #96c6d7;
}

.markdown-body .danger>.admonition-title {
  color: #c25f77;
}

.markdown-body .question>.admonition-title {
  color: #96a6d7;
}

.markdown-body .note>.admonition-title {
  color: #d7c896;
}

.markdown-body .admonition:before,
.markdown-body .attention:before,
.markdown-body .caution:before,
.markdown-body .hint:before,
.markdown-body .danger:before,
.markdown-body .question:before,
.markdown-body .note:before {
  font: normal normal 16px fontawesome-mini;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  line-height: 1.5;
  color: #333;
  position: absolute;
  left: 0;
  top: 0;
  padding-top: 10px;
  padding-left: 10px;
}

.markdown-body .admonition:before {
  content: "\f056\00a0";
  color: 333;
}

.markdown-body .attention:before {
  content: "\f058\00a0";
  color: #a6d796;
}

.markdown-body .caution:before {
  content: "\f06a\00a0";
  color: #d7a796;
}

.markdown-body .hint:before {
  content: "\f05a\00a0";
  color: #96c6d7;
}

.markdown-body .danger:before {
  content: "\f057\00a0";
  color: #c25f77;
}

.markdown-body .question:before {
  content: "\f059\00a0";
  color: #96a6d7;
}

.markdown-body .note:before {
  content: "\f040\00a0";
  color: #d7c896;
}

.markdown-body .admonition::after {
  content: normal;
}

.markdown-body .attention {
  border-left: 6px solid #a6d796;
}

.markdown-body .caution {
  border-left: 6px solid #d7a796;
}

.markdown-body .hint {
  border-left: 6px solid #96c6d7;
}

.markdown-body .danger {
  border-left: 6px solid #c25f77;
}

.markdown-body .question {
  border-left: 6px solid #96a6d7;
}

.markdown-body .note {
  border-left: 6px solid #d7c896;
}

.markdown-body .admonition>*:first-child {
  margin-top: 0 !important;
}

.markdown-body .admonition>*:last-child {
  margin-bottom: 0 !important;
}

/* progress bar*/
.markdown-body .progress {
  display: block;
  width: 300px;
  margin: 10px 0;
  height: 24px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #ededed;
  position: relative;
  box-shadow: inset -1px 1px 3px rgba(0, 0, 0, .1);
}

.markdown-body .progress-label {
  position: absolute;
  text-align: center;
  font-weight: bold;
  width: 100%; margin: 0;
  line-height: 24px;
  color: #333;
  text-shadow: 1px 1px 0 #fefefe, -1px -1px 0 #fefefe, -1px 1px 0 #fefefe, 1px -1px 0 #fefefe, 0 1px 0 #fefefe, 0 -1px 0 #fefefe, 1px 0 0 #fefefe, -1px 0 0 #fefefe, 1px 1px 2px #000;
  -webkit-font-smoothing: antialiased !important;
  white-space: nowrap;
  overflow: hidden;
}

.markdown-body .progress-bar {
  height: 24px;
  float: left;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #96c6d7;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, .5), inset 0 -1px 0 rgba(0, 0, 0, .1);
  background-size: 30px 30px;
  background-image: -webkit-linear-gradient(
    135deg, rgba(255, 255, 255, .4) 27%,
    transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%,
    transparent 77%, transparent
  );
  background-image: -moz-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -ms-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -o-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
}

.markdown-body .progress-100plus .progress-bar {
  background-color: #a6d796;
}

.markdown-body .progress-80plus .progress-bar {
  background-color: #c6d796;
}

.markdown-body .progress-60plus .progress-bar {
  background-color: #d7c896;
}

.markdown-body .progress-40plus .progress-bar {
  background-color: #d7a796;
}

.markdown-body .progress-20plus .progress-bar {
  background-color: #d796a6;
}

.markdown-body .progress-0plus .progress-bar {
  background-color: #c25f77;
}

.markdown-body .candystripe-animate .progress-bar{
  -webkit-animation: animate-stripes 3s linear infinite;
  -moz-animation: animate-stripes 3s linear infinite;
  animation: animate-stripes 3s linear infinite;
}

@-webkit-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@-moz-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

.markdown-body .gloss .progress-bar {
  box-shadow:
    inset 0 4px 12px rgba(255, 255, 255, .7),
    inset 0 -12px 0 rgba(0, 0, 0, .05);
}

/* MultiMarkdown Critic Blocks */
.markdown-body .critic_mark {
  background: #ff0;
}

.markdown-body .critic_delete {
  color: #c82829;
  text-decoration: line-through;
}

.markdown-body .critic_insert {
  color: #718c00 ;
  text-decoration: underline;
}

.markdown-body .critic_comment {
  color: #8e908c;
  font-style: italic;
}

.markdown-body .headeranchor {
  font: normal normal 16px fontawesome-mini;
  line-height: 1;
  display: inline-block;
  text-decoration: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.headeranchor:before {
  content: '\e157';
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 4px 0.25em -20px;
  vertical-align: middle;
}

/* Media */
@media only screen and (min-width: 480px) {
  .markdown-body {
    font-size:14px;
  }
}

@media only screen and (min-width: 768px) {
  .markdown-body {
    font-size:16px;
  }
}

@media print {
  .markdown-body * {
    background: transparent !important;
    color: black !important;
    filter:none !important;
    -ms-filter: none !important;
  }

  .markdown-body {
    font-size:12pt;
    max-width:100%;
    outline:none;
    border: 0;
  }

  .markdown-body a,
  .markdown-body a:visited {
    text-decoration: underline;
  }

  .markdown-body .headeranchor-link {
    display: none;
  }

  .markdown-body a[href]:after {
    content: " (" attr(href) ")";
  }

  .markdown-body abbr[title]:after {
    content: " (" attr(title) ")";
  }

  .markdown-body .ir a:after,
  .markdown-body a[href^="javascript:"]:after,
  .markdown-body a[href^="#"]:after {
    content: "";
  }

  .markdown-body pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .markdown-body pre,
  .markdown-body blockquote {
    border: 1px solid #999;
    padding-right: 1em;
    page-break-inside: avoid;
  }

  .markdown-body .progress,
  .markdown-body .progress-bar {
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
  }

  .markdown-body .progress {
    border: 1px solid #ddd;
  }

  .markdown-body .progress-bar {
    height: 22px;
    border-right: 1px solid #ddd;
  }

  .markdown-body tr,
  .markdown-body img {
    page-break-inside: avoid;
  }

  .markdown-body img {
    max-width: 100% !important;
  }

  .markdown-body p,
  .markdown-body h2,
  .markdown-body h3 {
    orphans: 3;
    widows: 3;
  }

  .markdown-body h2,
  .markdown-body h3 {
    page-break-after: avoid;
  }
}
</style><style>/*GitHub*/
.highlight {background-color:#fff;color:#333333;}
.highlight .hll {background-color:#ffffcc;}
.highlight .c{color:#999988;font-style:italic}
.highlight .err{color:#a61717;background-color:#e3d2d2}
.highlight .k{font-weight:bold}
.highlight .o{font-weight:bold}
.highlight .cm{color:#999988;font-style:italic}
.highlight .cp{color:#999999;font-weight:bold}
.highlight .c1{color:#999988;font-style:italic}
.highlight .cs{color:#999999;font-weight:bold;font-style:italic}
.highlight .gd{color:#000000;background-color:#ffdddd}
.highlight .ge{font-style:italic}
.highlight .gr{color:#aa0000}
.highlight .gh{color:#999999}
.highlight .gi{color:#000000;background-color:#ddffdd}
.highlight .go{color:#888888}
.highlight .gp{color:#555555}
.highlight .gs{font-weight:bold}
.highlight .gu{color:#800080;font-weight:bold}
.highlight .gt{color:#aa0000}
.highlight .kc{font-weight:bold}
.highlight .kd{font-weight:bold}
.highlight .kn{font-weight:bold}
.highlight .kp{font-weight:bold}
.highlight .kr{font-weight:bold}
.highlight .kt{color:#445588;font-weight:bold}
.highlight .m{color:#009999}
.highlight .s{color:#dd1144}
.highlight .n{color:#333333}
.highlight .na{color:teal}
.highlight .nb{color:#0086b3}
.highlight .nc{color:#445588;font-weight:bold}
.highlight .no{color:teal}
.highlight .ni{color:purple}
.highlight .ne{color:#990000;font-weight:bold}
.highlight .nf{color:#990000;font-weight:bold}
.highlight .nn{color:#555555}
.highlight .nt{color:navy}
.highlight .nv{color:teal}
.highlight .ow{font-weight:bold}
.highlight .w{color:#bbbbbb}
.highlight .mf{color:#009999}
.highlight .mh{color:#009999}
.highlight .mi{color:#009999}
.highlight .mo{color:#009999}
.highlight .sb{color:#dd1144}
.highlight .sc{color:#dd1144}
.highlight .sd{color:#dd1144}
.highlight .s2{color:#dd1144}
.highlight .se{color:#dd1144}
.highlight .sh{color:#dd1144}
.highlight .si{color:#dd1144}
.highlight .sx{color:#dd1144}
.highlight .sr{color:#009926}
.highlight .s1{color:#dd1144}
.highlight .ss{color:#990073}
.highlight .bp{color:#999999}
.highlight .vc{color:teal}
.highlight .vg{color:teal}
.highlight .vi{color:teal}
.highlight .il{color:#009999}
.highlight .gc{color:#999;background-color:#EAF2F5}
</style><title>README</title></head><body><article class="markdown-body"><h1 id="despliegue-continuo-en-kubernetes-con-gitops-y-argocd">Despliegue continuo en Kubernetes con GitOps y ArgoCD<a class="headerlink" href="#despliegue-continuo-en-kubernetes-con-gitops-y-argocd" title="Permanent link"></a></h1>
<h2 id="tabla-de-contenidos">Tabla de contenidos<a class="headerlink" href="#tabla-de-contenidos" title="Permanent link"></a></h2>
<ol>
<li><a href="#introduccion">Introducción</a></li>
<li><a href="#objetivos-del-proyecto">Objetivos del proyecto</a></li>
<li><a href="#fundamentos-teoricos-y-conceptos-previos">Fundamentos teóricos y conceptos previos</a><ol>
<li><a href="#gitops">GitOps</a><ol>
<li><a href="#¿que-es-gitops?">¿Qué es GitOps?</a></li>
<li><a href="#principio-de-gitops">Principios de GitOps</a></li>
<li><a href="#ventajas-e-inconvenientes-de-gitops">Ventajas e inconvenientes de GitOps</a></li>
</ol>
</li>
<li><a href="#argocd">ArgoCD</a></li>
</ol>
</li>
<li><a href="#escenario-necesario-para-la-realización-del-proyecto">Escenario necesario para la realización del proyecto</a><ol>
<li><a href="#instalación-de-argocd-con-declaraciones">Instalación de ArgoCD con declaraciones</a></li>
<li><a href="#instalación-de-argocd-con-autopilot">Instalación de ArgoCD con Autopilot</a></li>
<li><a href="#instalación-de-argocd-con-helm">Instalación de ArgoCD con Helm</a></li>
<li><a href="#configuración-de-argocd">Configuración de ArgoCD</a></li>
</ol>
</li>
<li><a href="#desarrollo-del-proyecto">Desarrollo del proyecto</a></li>
<li><a href="#conclusiones-y-propuestas-adicionales-para-el-proyecto">Conclusiones y propuestas adicionales para el proyecto</a></li>
<li><a href="#dificultades-encontradas-en-el-proyecto">Dificultades encontradas en el proyecto</a></li>
<li><a href="#bibliografia">Bibliografía</a></li>
</ol>
<hr />
<h2 id="introduccion">Introducción<a class="headerlink" href="#introduccion" title="Permanent link"></a></h2>
<p><br></p>
<h2 id="objetivos-del-proyecto">Objetivos del proyecto<a class="headerlink" href="#objetivos-del-proyecto" title="Permanent link"></a></h2>
<p><br></p>
<h2 id="fundamentos-teoricos-y-conceptos-previos">Fundamentos teóricos y conceptos previos<a class="headerlink" href="#fundamentos-teoricos-y-conceptos-previos" title="Permanent link"></a></h2>
<h3 id="gitops">GitOps<a class="headerlink" href="#gitops" title="Permanent link"></a></h3>
<h4 id="que-es-gitops">¿Qué es GitOps?<a class="headerlink" href="#que-es-gitops" title="Permanent link"></a></h4>
<p>Para explicar ArgoCD, antes debemos conocer el concepto de <strong>GitOps</strong>. El término deriva de la unión de las palabras Git (software de control de versiones) y Ops (operaciones), y surge en 2017, junto con la creciente popularidad de los contenedores y la computación en la nube, como un conjunto de buenas prácticas para la gestión de infraestructuras en Kubernetes y la entrega de aplicaciones. Se trata de una metodología en la que se emplea Git para gestionar todas las fases en el desarrollo de un proyecto.</p>
<p align="center">
<img src="/home/lpruna/github/DespliegueArgoCD/images/Short-GitOps-Timeline-Light.png" alt="Proceso de despliegue sin GitOps" width="750"/>
</p>

<p>GitOps se considera una forma mejorada de infraestructura como código (<strong>Infrastructure as Code, IaC</strong>), que no es más que un mecanismo para crear y mantener infraestructuras usando código para definirlas y automatizar su configuración, en lugar de hacerlo todo manualmente. Normalmente, el código se encuentra en ficheros legibles por la máquina, y almacenados de manera que se pueda llevar a cabo un control de versiones.</p>
<p>Las IaC, como Ansible o Terraform, nos permiten ahorrar tiempo a la hora de desplegar nuestra infraestructura en un entorno y reproducirla en otro, pero con la llegada de las <strong>plataformas en la nube</strong> y, sobre todo, de los <strong>contenedores</strong>, la forma de aprovisionar dichas infraestructuras ha ido cambiando considerablemente y a un paso vertiginoso. Como consecuencia de esto, y siendo Git cada vez más el sistema de control de versiones predominante, GitOps ha ido ganando altura, pues va más allá del resto de IaC cuando se trata de definir todos los componentes del software (la infraestructura, la red, los datos y la aplicación) en forma de código (Everything as a Code, EaaC).</p>
<p>Con GitOps, podremos usar determinados agentes para que nos informen de cualquier <strong>divergencia</strong> que exista entre el código almacenado en Git y el que se está ejecutando en los clústeres. Si se encuentra alguna diferencia, los reconciliadores de Kubernetes se encargan de actualizar o hacer un <em>rollback</em> en el cluster.</p>
<p><br></p>
<h4 id="principios-de-gitops">Principios de GitOps<a class="headerlink" href="#principios-de-gitops" title="Permanent link"></a></h4>
<p>La metodología GitOps sigue estos cuatro principios:</p>
<ol>
<li>
<p><strong>Todo el sistema se define usando un lenguaje declarativo</strong>: esto significa que la configuración se realiza indicando lo que se debe hacer en lugar de cómo debería hacerse (hechos en lugar de instrucciones). De esta manera, se puede leer el código de la infraestructura desde un repositorio fácilmente.</p>
</li>
<li>
<p><strong>Git es la única fuente de verdad</strong>: al almacenar la declaración del sistema en un sistema de control de versiones, podremos ir siguiendo la evolución de todo el código desde un único lugar. Además, esto facilita el hecho de volver a una versión anterior si algo sale mal. Git también nos permite hacer uso de claves SSH para firmar los cambios, lo que nos garantiza una mayor seguridad en la autoría y procedencia del código.</p>
</li>
<li>
<p><strong>Los cambios aprobados se aplican automáticamente al sistema</strong>: una vez se ha declarado el código en Git, el siguiente paso es permitir que cualquier cambio que hagamos ahí se aplique de forma automática en el sistema. La clave de esto es que no necesitamos usar las credenciales del cluster para cambiar el sistema, bastará con realizar un &ldquo;commit&rdquo; o un &ldquo;pull request&rdquo;.</p>
</li>
<li>
<p><strong>Uso de agentes para asegurar la corrección y las alertas de divergencia</strong>: ya declarada la infraestructura y almacenada en un sistema de control de versiones, los agentes nos informarán de cualquier estado que se aleje de nuestras expectativas. El uso de agentes también nos asegura la autocorrección del sistema en el caso de que se produzca un error humano, en cuyo caso el agente tratará de aplicar sus propias soluciones (como volver a desplegar la aplicación) para recuperar el estado deseado.</p>
</li>
</ol>
<p><br></p>
<h4 id="ventajas-e-inconvenientes-de-gitops">Ventajas e inconvenientes de GitOps<a class="headerlink" href="#ventajas-e-inconvenientes-de-gitops" title="Permanent link"></a></h4>
<p>Este es el proceso que se realiza en un despliegue tradicional <strong>sin GitOps</strong>:</p>
<ol>
<li>El desarrollador guarda los cambios en el código fuente de la aplicación.</li>
<li>Un sistema de integración continua construye la aplicación, y puede llegar a realizar otras tareas, como pruebas unitarias, escaneos de seguridad, verificaciones de estado, etc.</li>
<li>La imagen del contenedor se almacena de un registro de contenedores.</li>
<li>La plataforma de IC (u otro sistema externo) con acceso directo al cluster de Kubernetes crea un despliegue usando una variación del comando &ldquo;kubectl apply&rdquo;.</li>
<li>La aplicación se despliega en el cluster.</li>
</ol>
<p align="center">
<img src="/home/lpruna/github/DespliegueArgoCD/images/ProcesoDespliegueSinGitOps.png" alt="Proceso de despliegue sin GitOps" width="750"/>
</p>

<p>Aspectos a destacar de este proceso:</p>
<ul>
<li>El estado del cluster se decide de forma <strong>manual</strong> mediante comandos de kubectl o accesos API.</li>
<li>La plataforma que despliega el cluster de Kubernetes tiene <strong>total acceso</strong> a este desde un punto externo.</li>
</ul>
<p>GitOps nos permite modificar el proceso para que sea como sigue:</p>
<ol>
<li>Los primeros pasos son los mismos: el desarrollador aplica los cambios del código fuente, y el sistema de IC crea un despliegue que se guarda en un registro.</li>
<li>Nadie tiene acceso directo al cluster de Kubernetes, y hay un segundo repositorio Git con todas las declaraciones que definen la aplicación.</li>
<li>Otra persona o un sistema automatizado cambia las declaraciones en el segundo repositorio Git.</li>
<li>Un controlador de GitOps que se ejecuta dentro del cluster monitoriza el repositorio Git y modifica el estado del cluster tan pronto se aplique un cambio, para hacer coincidir dicho estado con el que se describe en Git.</li>
</ol>
<p align="center">
<img src="/home/lpruna/github/DespliegueArgoCD/images/ProcesoDespliegueConGitOps.png" alt="Proceso de despliegue con GitOps" width="750"/>
</p>

<p>Aspectos a destacar de este proceso:</p>
<ul>
<li>El estado del cluster siempre se describe en <strong>Git</strong>, donde se almacena todo lo que forma parte de la aplicación.</li>
<li>No hay ningún sistema de despliegue externo con total acceso al cluster. Es el <strong>propio cluster</strong> el que obtiene los cambios y la información del despliegue.</li>
<li>El controlador de GitOps se ejecuta en un <strong>bucle constante</strong> que sincroniza el estado del repositorio Git con el del cluster.</li>
</ul>
<p>De esto podemos deducir que GitOps ofrece las siguientes <strong>ventajas</strong>:</p>
<ul>
<li>Una mayor productividad, al reducir el trabajo humano.</li>
<li>Una experiencia de desarrollo mejorada, al facilitarle las tareas al desarrollador.</li>
<li>Una mayor estabilidad, ya que Git ofrece un registro más completo de todos los cambios realizados.</li>
<li>Una mayor fiabilidad, puesto que siempre se puede dar marcha atras con un rollback en el caso de que algo salga mal.</li>
<li>Consistencia y estandarización, porque GitOps ofrece un modelo para desarrollar infraestructuras, aplicaciones y cambios adicionales en Kubernetes de principio a fin.</li>
<li>Una mayor garantía de seguridad, tanto en la integración de los datos como a la hora de probar la autoría y origen de los mismos.</li>
</ul>
<p>Hay que mencionar que no todo es oro en GitOps: el almacenamiento de <strong>objetos de tipo <em>Secret</em></strong> en Git supone un problema, puesto que este valor suele codificarse (que no encriptarse) en base64, lo cual resulta muy fácil de descodificar. No obstante, algunas empresas le han dado solución a este problema, como los <em>Sealed Secrets</em> de Bitnami, que encriptan los <em>Secrets</em> para que sea seguro almacenarlos en Git.</p>
<p><br></p>
<h3 id="argocd">ArgoCD<a class="headerlink" href="#argocd" title="Permanent link"></a></h3>
<p>ArgoCD, perteneciente a la Cloud Native Computing Foundation (CNCF), es una de las herramientas más populares actualmente (y de las primeras que apareció en el mercado) para desplegar de forma continua aplicaciones en Kubernetes y con base de GitOps. No solo se la conoce por su excelente <strong>administración y despliegue de aplicaciones de Kubernetes</strong>, sino también por sus funciones de autocorrección de errores, gestión de acceso de usuarios, verificación de estado, etc. ArgoCD implementa todos los principios de GitOps que hemos descrito antes de la siguiente manera:</p>
<ol>
<li>Instalamos Argo CD como un controlador en el cluster de Kubernetes. Normalmente, lo instalaremos en el mismo cluster que va a gestionar, aunque también puede administrar otros clústeres externos.</li>
<li>Almacenamos las declaraciones en Git, sean del tipo que sean. ArgoCD es bastante abierto a este respecto, soporta tanto declaraciones simples de Kubernetes como <em>charts</em> de Helm, definiciones de Kustomize y otros sistemas de plantillas.</li>
<li>Creamos una aplicación en ArgoCD indicando qué repositorio Git va a monitorizar, y en qué cluster o espacio de nombre deberá instalarse dicha aplicación.</li>
<li>Desde este momento, ArgoCD monitorizará el repositorio de Git, y cuando haya algún cambio, modificará el cluster de forma automática para que tenga el mismo estado.</li>
<li>De manera opcional, ArgoCD desplegará aplicaciones en otros clústeres (no solo en el que se encuentra instalado).</li>
</ol>
<p align="center">
<img src="/home/lpruna/github/DespliegueArgoCD/images/ProcesoArgoCD.png" alt="Proceso de ArgoCD" width="750"/>
</p>

<p>Este es el proceso básico de despliegue de ArgoCD, pero también cuenta con otras características (que describiremos más adelante), como:</p>
<ul>
<li>Sincronización manual o automática</li>
<li>Definición de oleadas y marcos de sincronización (<em>Sync Waves</em> y <em>Sync Windows</em>, respectivamente)</li>
<li>Configuración declarativa de aplicaciones</li>
</ul>
<p>Argo CD cuenta con una <strong>interfaz gráfica integrada</strong> clara y fácil de administrar, donde se muestra tanto la estructura de la aplicación como estado de la sincronización. Tras desplegarla, ArgoCD irá realizando <em>pulls</em> a los repositorios añadidos para comparar el estado de estos con el de los clústeres.</p>
<p align="center">
<img src="/home/lpruna/github/DespliegueArgoCD/images/InterfazGrafica.png" alt="Interfaz gráfica de ArgoCD" width="750"/>
</p>

<p>Con ArgoCD no solo podremos desplegar aplicaciones usando <strong>ficheros yaml y json</strong>, sino también herramientas como <strong>Helm, Kustomize, Ksonnet</strong>, etc. Permite la <strong>autenticación</strong> mediante OICD, OAuth2, LDAP, SAML 2.0, Github, GitLab, Microsoft, etc., y emplea una política basada en roles. En cuanto a la gestión de <strong><em>Secrets</em></strong>, ArgoCD es compatible con Bitnami Sealed Secrets, Godaddy K8S External Secrets, Vault, Banzai Cloud Bank Vaults, Helm Secrets, Kustomize Secrets y AWS Secret Operator.</p>
<p><br></p>
<h2 id="escenario-necesario-para-la-realizacion-del-proyecto">Escenario necesario para la realización del proyecto<a class="headerlink" href="#escenario-necesario-para-la-realizacion-del-proyecto" title="Permanent link"></a></h2>
<p>En este apartado describiremos el proceso de instalación de ArgoCD para poder desplegar posteriormente nuestra aplicación. Existen varias formas de instalarlo en un cluster de Kubernetes:</p>
<h3 id="instalacion-de-argocd-con-declaraciones">Instalación de ArgoCD con declaraciones<a class="headerlink" href="#instalacion-de-argocd-con-declaraciones" title="Permanent link"></a></h3>
<p>Si solo queremos ArgoCD para hacer pruebas y experimentar con la herramienta, podemos desplegar ArgoCD directamente con el fichero install.yaml que nos ofrece ArgoCD en su <a href="https://github.com/argoproj/argo-cd/tree/master/manifests">repositorio de GitHub</a>. Creamos un espacio de nombre y aplicamos dicho archivo en el mismo.
<div class="highlight"><pre>lpruna@debian:~$ kubectl create namespace argocd
lpruna@debian:~$ kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml

lpruna@debian:~$ kubectl get all -n argocd
NAME                                                    READY   STATUS    RESTARTS   AGE
pod/argocd-application-controller-0                     1/1     Running   0          101s
pod/argocd-applicationset-controller-79f97597cb-p2g4l   1/1     Running   0          102s
pod/argocd-dex-server-6fd8b59f5b-4p2jf                  1/1     Running   0          102s
pod/argocd-notifications-controller-5549f47758-xsm4m    1/1     Running   0          102s
pod/argocd-redis-79bdbdf78f-x4868                       1/1     Running   0          102s
pod/argocd-repo-server-5569c7b657-zn9ql                 1/1     Running   0          102s
pod/argocd-server-664b7c6878-l7vlm                      1/1     Running   0          101s

NAME                                              TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                      AGE
service/argocd-applicationset-controller          ClusterIP   10.103.132.210   &lt;none&gt;        7000/TCP                     102s
service/argocd-dex-server                         ClusterIP   10.98.252.112    &lt;none&gt;        5556/TCP,5557/TCP,5558/TCP   102s
service/argocd-metrics                            ClusterIP   10.104.107.166   &lt;none&gt;        8082/TCP                     102s
service/argocd-notifications-controller-metrics   ClusterIP   10.103.223.62    &lt;none&gt;        9001/TCP                     102s
service/argocd-redis                              ClusterIP   10.110.177.243   &lt;none&gt;        6379/TCP                     102s
service/argocd-repo-server                        ClusterIP   10.107.77.98     &lt;none&gt;        8081/TCP,8084/TCP            102s
service/argocd-server                             ClusterIP   10.110.54.94     &lt;none&gt;        80/TCP,443/TCP               102s
service/argocd-server-metrics                     ClusterIP   10.103.70.41     &lt;none&gt;        8083/TCP                     102s

NAME                                               READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/argocd-applicationset-controller   1/1     1            1           102s
deployment.apps/argocd-dex-server                  1/1     1            1           102s
deployment.apps/argocd-notifications-controller    1/1     1            1           102s
deployment.apps/argocd-redis                       1/1     1            1           102s
deployment.apps/argocd-repo-server                 1/1     1            1           102s
deployment.apps/argocd-server                      1/1     1            1           102s

NAME                                                          DESIRED   CURRENT   READY   AGE
replicaset.apps/argocd-applicationset-controller-79f97597cb   1         1         1       102s
replicaset.apps/argocd-dex-server-6fd8b59f5b                  1         1         1       102s
replicaset.apps/argocd-notifications-controller-5549f47758    1         1         1       102s
replicaset.apps/argocd-redis-79bdbdf78f                       1         1         1       102s
replicaset.apps/argocd-repo-server-5569c7b657                 1         1         1       102s
replicaset.apps/argocd-server-664b7c6878                      1         1         1       101s

NAME                                             READY   AGE
statefulset.apps/argocd-application-controller   1/1     101s
</pre></div></p>
<p>En el mismo repositorio tenemos disponible otro archivo yaml llamado &ldquo;namespace-install.yaml&rdquo;, con el que instalaremos ArgoCD como en el caso anterior. La única diferencia es que este está pensado para entornos con muchos usuarios repartidos entre diferentes equipos y proyectos, entre los cuales se han dividido los recursos del cluster mediante el uso de <strong>espacios de nombre</strong>. En este sentido, namespace-install.yaml permite instalar ArgoCD en un espacio de nombre concreto, y no requiere que tengamos privilegios a nivel de cluster. Esta es la mejor opción si queremos instalar ArgoCD en un solo cluster pero que también pueda gestionar otros externos.</p>
<p>Por último, también tenemos la opción de instalar ArgoCD en <strong>alta disponibilidad</strong>. El proceso es similar a los casos anteriores, con la única diferencia de que aquí se crearán múltiples réplicas para los distintos componentes.
<div class="highlight"><pre>lpruna@debian:~$ kubectl create namespace argocd
lpruna@debian:~$ kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/ha/install.yaml

lpruna@debian:~$ kubectl get all -n argocd
NAME                                                    READY   STATUS              RESTARTS   AGE
pod/argocd-application-controller-0                     0/1     ContainerCreating   0          5s
pod/argocd-applicationset-controller-79f97597cb-bx2hk   1/1     Running             0          6s
pod/argocd-dex-server-6fd8b59f5b-m7xvs                  0/1     Init:0/1            0          6s
pod/argocd-notifications-controller-5549f47758-b69bl    0/1     ContainerCreating   0          5s
pod/argocd-redis-ha-haproxy-5b75bb98dc-jtk8x            0/1     Pending             0          5s
pod/argocd-redis-ha-haproxy-5b75bb98dc-x6lk9            0/1     Pending             0          5s
pod/argocd-redis-ha-haproxy-5b75bb98dc-xw7lw            0/1     Init:0/1            0          5s
pod/argocd-redis-ha-server-0                            0/2     Init:0/1            0          5s
pod/argocd-repo-server-67c5d5bf75-5cwjl                 0/1     PodInitializing     0          5s
pod/argocd-repo-server-67c5d5bf75-njdcc                 0/1     Pending             0          5s
pod/argocd-server-757f6d6795-gw4bs                      0/1     ContainerCreating   0          5s
pod/argocd-server-757f6d6795-pfs5z                      0/1     Pending             0          5s

NAME                                              TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                      AGE
service/argocd-applicationset-controller          ClusterIP   10.102.66.212    &lt;none&gt;        7000/TCP                     6s
service/argocd-dex-server                         ClusterIP   10.97.97.253     &lt;none&gt;        5556/TCP,5557/TCP,5558/TCP   6s
service/argocd-metrics                            ClusterIP   10.107.125.159   &lt;none&gt;        8082/TCP                     6s
service/argocd-notifications-controller-metrics   ClusterIP   10.104.154.138   &lt;none&gt;        9001/TCP                     6s
service/argocd-redis-ha                           ClusterIP   None             &lt;none&gt;        6379/TCP,26379/TCP           6s
service/argocd-redis-ha-announce-0                ClusterIP   10.100.78.54     &lt;none&gt;        6379/TCP,26379/TCP           6s
service/argocd-redis-ha-announce-1                ClusterIP   10.104.171.78    &lt;none&gt;        6379/TCP,26379/TCP           6s
service/argocd-redis-ha-announce-2                ClusterIP   10.97.51.120     &lt;none&gt;        6379/TCP,26379/TCP           6s
service/argocd-redis-ha-haproxy                   ClusterIP   10.103.93.213    &lt;none&gt;        6379/TCP                     6s
service/argocd-repo-server                        ClusterIP   10.102.153.79    &lt;none&gt;        8081/TCP,8084/TCP            6s
service/argocd-server                             ClusterIP   10.105.140.145   &lt;none&gt;        80/TCP,443/TCP               6s
service/argocd-server-metrics                     ClusterIP   10.105.227.247   &lt;none&gt;        8083/TCP                     6s

NAME                                               READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/argocd-applicationset-controller   1/1     1            1           6s
deployment.apps/argocd-dex-server                  0/1     1            0           6s
deployment.apps/argocd-notifications-controller    0/1     1            0           6s
deployment.apps/argocd-redis-ha-haproxy            0/3     3            0           6s
deployment.apps/argocd-repo-server                 0/2     2            0           5s
deployment.apps/argocd-server                      0/2     2            0           5s

NAME                                                          DESIRED   CURRENT   READY   AGE
replicaset.apps/argocd-applicationset-controller-79f97597cb   1         1         1       6s
replicaset.apps/argocd-dex-server-6fd8b59f5b                  1         1         0       6s
replicaset.apps/argocd-notifications-controller-5549f47758    1         1         0       6s
replicaset.apps/argocd-redis-ha-haproxy-5b75bb98dc            3         3         0       5s
replicaset.apps/argocd-repo-server-67c5d5bf75                 2         2         0       5s
replicaset.apps/argocd-server-757f6d6795                      2         2         0       5s

NAME                                             READY   AGE
statefulset.apps/argocd-application-controller   0/1     5s
statefulset.apps/argocd-redis-ha-server          0/3     5s
</pre></div></p>
<p><br></p>
<h3 id="instalacion-de-argocd-con-autopilot">Instalación de ArgoCD con Autopilot<a class="headerlink" href="#instalacion-de-argocd-con-autopilot" title="Permanent link"></a></h3>
<p align="center">
<img src="/home/lpruna/github/DespliegueArgoCD/images/argo_autopilot.png" alt="ArgoCD en piloto automático" width="450"/>
</p>

<p>Si queremos trabajar directamente en un entorno de producción, tenemos a nuestra disposición la herramienta <a href="https://github.com/argoproj-labs/argocd-autopilot">Autopilot</a>, que además de instalar la propia aplicación de ArgoCD y desplegarla en un cluster de Kubernetes, guarda toda la configuración en un repositorio de GitOps para que se gestione a sí misma. Una vez instalado ArgoCD, ya podremos crear nuestros proyectos y aplicaciones con esta misma herramienta, que guardará todas las definiciones en el repositorio creado. Por su parte, ArgoCD notará los cambios en dicho repositorio y los aplicará al cluster, dando lugar a un proceso de despliegue continuo.</p>
<p>Para instalar Autopilot en Linux, podemos usar varias herramientas:</p>
<ul>
<li><strong>brew</strong>, con el que ejecutaremos un único comando:</li>
</ul>
<div class="highlight"><pre>brew install argocd-autopilot
</pre></div>

<ul>
<li><strong>curl</strong>, con el que podemos bajarnos la última versión de Autopilot directamente desde el repositorio oficial:</li>
</ul>
<div class="highlight"><pre># Guardamos en una variable la última versión de Autopilot
VERSION=$(curl --silent &quot;https://api.github.com/repos/argoproj-labs/argocd-autopilot/releases/latest&quot; | grep &#39;&quot;tag_name&quot;&#39; | sed -E &#39;s/.*&quot;([^&quot;]+)&quot;.*/\1/&#39;)

# Nos descargamos el paquete .tar.gz de dicha versión y extraemos el binario de instalación
curl -L --output - https://github.com/argoproj-labs/argocd-autopilot/releases/download/$VERSION/argocd-autopilot-linux-amd64.tar.gz | tar zx

# Movemos el comando a nuestro directorio de binarios
mv ./argocd-autopilot-* /usr/local/bin/argocd-autopilot

# Ya tendremos instalado Autopilot, con el siguiente comando podremos ver la ayuda para empezar a usarlo
argocd-autopilot help
</pre></div>

<ul>
<li>También podemos utilizar una <strong>imagen de Docker</strong>, especificando las rutas en las que vamos a montar los directorios .kube y .gitconfig:</li>
</ul>
<div class="highlight"><pre>docker run \
  -v ~/.kube:/home/autopilot/.kube \
  -v ~/.gitconfig:/home/autopilot/.gitconfig \
  -it quay.io/argoprojlabs/argocd-autopilot &lt;cmd&gt; &lt;flags&gt;
</pre></div>

<p>En las dos últimas etiquetas, indicaremos los comandos que queremos ejecutar con la herramienta Autopilot, que en principio serán los necesarios para instalar ArgoCD y el controlador de aplicaciones, así como para crear nuestro primer proyecto.</p>
<p>Una vez tengamos instalado Autopilot, el siguiente paso será crear un <strong>token de Git</strong> para Autopilot. Para ello, nos vamos a los ajustes de nuestra cuenta de GitHub, y entramos en la pestaña &ldquo;Ajustes de desarrollador&rdquo; &gt; &ldquo;Tokens de acceso personal&rdquo;, y generamos un nuevo token. Le damos un nombre e indicamos el periodo de validez y los permisos que queremos darle (en este caso, bastaría con marcar la casilla &ldquo;repo&rdquo;, puesto que lo que va a hacer Autopilot principalmente es crear y modificar repositorios). </p>
<p align="center">
<img src="/home/lpruna/github/DespliegueArgoCD/images/NewPersonalAccessToken.png" alt="ArgoCD en piloto automático" width="750"/>
</p>

<p>Nota: es importante que copiemos el token antes de salir de la página, ya que no podremos volver a verlo.</p>
<p>Hecho esto, crearemos un repositorio en GitHub para Autopilot (también podemos dejar que sea Autopilot quien lo cree), y generaremos dos variables de entorno en la máquina donde lo tengamos instalado:
<div class="highlight"><pre># Nuestro token de Git
export GIT_TOKEN=ghp_d3nrpZHPTCGAOYBZop1VDCBDHQVgTj0OYxPu

# La URL de nuestro repositorio
export GIT_REPO=https://github.com/LaraPruna/autopilot.git
</pre></div></p>
<p>A continuación, ejecutamos el arranque de instalación en nuestro entorno de Kubernetes, con lo que se instalará ArgoCD y el controlador de aplicaciones.
<div class="highlight"><pre>argocd-autopilot repo bootstrap
</pre></div></p>
<p>Con esto, se nos habrá creado el <a href="https://github.com/LaraPruna/autopilot">repositorio</a> (si no existía ya) con tres directorios: apps, bootstrap y projects. También se nos indicará al final de la instalación el usuario y la contraseña para acceder a ArgoCD y el comando que necesitamos para realizar un <em>port-forward</em>:
<div class="highlight"><pre>INFO pushing bootstrap manifests to repo          
Resolving deltas: 100% (1/1), done.
INFO applying argo-cd bootstrap application       
application.argoproj.io/autopilot-bootstrap created
INFO running argocd login to initialize argocd config 
&#39;admin:login&#39; logged in successfully
Context &#39;autopilot&#39; updated

INFO argocd initialized. password: **************** 
INFO run:

    kubectl port-forward -n argocd svc/argocd-server 8080:80
</pre></div></p>
<p align="center">
<img src="/home/lpruna/github/DespliegueArgoCD/images/PortalArgoCD.png" alt="Portal de ArgoCD" width="750"/>
<img src="/home/lpruna/github/DespliegueArgoCD/images/PortalArgoCD2.png" alt="Proyectos de Autopilot en ArgoCD" width="750"/>
</p>

<p>Si olvidamos la contraseña del administrador de ArgoCD, siempre podemos recuperarla con el siguiente comando:
<div class="highlight"><pre>kubectl get secret argocd-initial-admin-secret -n argocd -ogo-template=&#39;{{printf &quot;%s\n&quot; (index (index . &quot;data&quot;) &quot;password&quot; | base64decode)}}&#39;
</pre></div></p>
<p>Lo siguiente sería crear nuestro primer proyecto. Para ello, ejecutamos el siguiente comando:
<div class="highlight"><pre>argocd-autopilot project create mi-primer-proyecto
</pre></div></p>
<p>Por último, instalamos nuestra primera aplicación en el proyecto, habiendo creado previamente un repositorio para la misma. En la documentación de Autopilot nos ofrecen una aplicación de prueba:
<div class="highlight"><pre>argocd-autopilot app create demoapp --app github.com/argoproj-labs/argocd-autopilot/examples/demo-app/ -p mi-primer-proyecto
</pre></div></p>
<p>Si nos vamos a la interfaz gráfica de ArgoCD, veremos que nos aparece la aplicación instalada:</p>
<p align="center">
<img src="/home/lpruna/github/DespliegueArgoCD/images/demoapp-argocd.png" alt="Nueva app en ArgoCD" width="750"/>
</p>

<p>En el repositorio de Autopilot también se nos habrá añadido un nuevo directorio para la app:</p>
<p align="center">
<img src="/home/lpruna/github/DespliegueArgoCD/images/demoapp-git.png" alt="Nueva app en GitOps" width="750"/>
</p>

<p>Para desinstalar Autopilot, usamos el argumento <code>uninstall</code>, con el que se borrarán el repositorio donde hemos guardado la herramienta y los recursos del mismo en el cluster de Kubernetes.
<div class="highlight"><pre>argocd-autopilot repo uninstall
</pre></div></p>
<p><br></p>
<h3 id="instalacion-de-argocd-con-helm">Instalación de ArgoCD con Helm<a class="headerlink" href="#instalacion-de-argocd-con-helm" title="Permanent link"></a></h3>
<p>Si tenemos Helm instalado en nuestra máquina, podemos emplear un <a href="https://github.com/argoproj/argo-helm/tree/master/charts/argo-cd">chart de ArgoCD</a> para instalarlo. Para ello, primero añadimos el repositorio de argo:
<div class="highlight"><pre>helm repo add argo https://argoproj.github.io/argo-helm
</pre></div></p>
<p>Después, instalamos el chart desde el mismo:
<div class="highlight"><pre>helm install my-release argo/argo-cd
</pre></div></p>
<p>Si queremos tener el chart de ArgoCD en alta disponibilidad, tendríamos que editar el fichero <code>values.yaml</code> y modificar los valores que se muestran a continuación, dependiendo de si queremos habilitar o no el autoescalado:</p>
<ul>
<li>
<p>Alta disponibilidad con autoescalado:
<div class="highlight"><pre>redis-ha:
  enabled: true

controller:
  enableStatefulSet: true

server:
  autoscaling:
    enabled: true
    minReplicas: 2

repoServer:
  autoscaling:
    enabled: true
    minReplicas: 2
</pre></div></p>
</li>
<li>
<p>Alta disponibilidad sin autoescalado:
<div class="highlight"><pre>redis-ha:
  enabled: true

controller:
  enableStatefulSet: true

server:
  replicas: 2
  env:
    - name: ARGOCD_API_SERVER_REPLICAS
      value: &#39;2&#39;

repoServer:
  replicas: 2
</pre></div></p>
</li>
</ul>
<p><br></p>
<h3 id="configuracion-de-argocd">Configuración de ArgoCD<a class="headerlink" href="#configuracion-de-argocd" title="Permanent link"></a></h3>
<p>Una vez tengamos instalado ArgoCD mediante cualquiera de las opciones descritas antes, podemos personalizarlo según nuestras necesidades. Hay que tener en cuenta que, si lo hemos <strong>instalado con Autopilot</strong>, no podremos realizar ningún tipo de modificación en los ficheros de configuración, puesto que dicha aplicación se encargará de restaurarlos al menor cambio. Esto se debe a que, como he mencionado anteriormente, Autopilot está pensado para que la aplicación de ArgoCD se gestione por sí sola. Por lo tanto, si ese es el caso, podéis ignorar este apartado y continuar en el siguiente.</p>
<p>Dicho esto, para empezar a configurar ArgoCD, podemos generar un recurso <strong><em>Ingress</em></strong> para poder acceder a la interfaz gráfica a través de un nombre de dominio en lugar de una dirección IP. Para ahorrarnos tener que generar certificados SSL, editamos el recurso <code>deployments.apps/argocd-server</code>:
<div class="highlight"><pre>kubectl edit -n argocd deployments.apps argocd-server
</pre></div></p>
<p>Nos dirigimos a la línea donde se define el comando <code>argocd-server</code> y añadimos debajo la opción <code>--insecure</code>:
<div class="highlight"><pre>containers:
- command:
  - argocd-server
  - --insecure
</pre></div></p>
<p>Ya podríamos crear el <em>Ingress</em> de la manera tradicional:
<div class="highlight"><pre>apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: argocd-ingress
spec:
  rules:
  - host: www.argocd.org
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: argocd-server
            port:
              number: 80
</pre></div></p>
<p>Finalmente, aplicamos el fichero yaml:
<div class="highlight"><pre>kubectl apply -n argocd -f ingress.yaml
</pre></div></p>
<p>Hecho esto, solo quedaría añadir el dominio a nuestro servidor DNS o realizar una resolución estática en el fichero <code>/etc/hosts</code> de nuestra máquina.</p>
<p align="center">
<img src="/home/lpruna/github/DespliegueArgoCD/images/PortalArgoCD_dominio.png" alt="Accediendo al portal de ArgoCD con un dominio" width="750"/>
</p>

<p>Una vez comprobemos que podemos acceder a ArgoCD a través con el Ingress, es recomandable que, por razones de seguridad, creemos <strong>usuarios locales</strong> en lugar de utilizar el usuario <code>admin</code> que se nos proporciona al final de la instalación. El uso de usuarios locales nos permite no solo gestionar el acceso de estos de manera independiente, sino también configurar una cuenta API con permisos limitados y generar un token de autenticación con el que el usuario podrá crear proyectos y aplicaciones automáticamente. Para ello, crearemos un recurso <em>ConfigMap</em> para cada usuario con el siguiente contenido:
<div class="highlight"><pre>apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
  namespace: argocd
  labels:
    app.kubernetes.io/name: argocd-cm
    app.kubernetes.io/part-of: argocd
data:
  # En este caso, añadimos un usuario local con los privilegios apikey y login
  #   apiKey: permite generar claves API
  #   login: permite iniciar sesión en la interfaz de usuario
  # El nombre de usuario no debe pasarse de los 32 caracteres
  accounts.lara: apiKey, login
  # La siguiente línea deshabilita el usuario, que por defecto está habilitado
  #accounts.lara.enabled: &quot;false&quot;
</pre></div></p>
<p>Al aplicar el fichero yaml, habremos creado un nuevo usuario. Para comprobarlo, entramos en el pod argocd-server e iniciamos sesión con el usuario <code>admin</code> (el comando para obtener la contraseña del administrador inicial se indica en el apartado de instalación con Autopilot):
<div class="highlight"><pre>lpruna@debian:~$ kubectl exec -it pod/argocd-server-6456fd8bd6-n8x9g  -- bash
argocd@argocd-server-6456fd8bd6-n8x9g:~$ argocd login www.argocd.org --insecure
Username: admin
Password:
</pre></div></p>
<p>A continuación, ejecutamos el siguiente comando para ver la lista de usuarios en ArgoCD:
<div class="highlight"><pre>argocd@argocd-server-6456fd8bd6-n8x9g:~$ argocd account list --grpc-web
NAME   ENABLED  CAPABILITIES
admin  true     login
lara   true     apiKey, login
</pre></div></p>
<p>Como vemos, el nuevo usuario puede iniciar sesión y generar claves API. Con el siguiente comando, podemos obtener más información sobre el usuario:
<div class="highlight"><pre>argocd@argocd-server-6456fd8bd6-n8x9g:~$ argocd account get --account lara 
Name:               lara
Enabled:            true
Capabilities:       apiKey, login

Tokens:
NONE
</pre></div></p>
<p>El siguiente paso es generar una contraseña para el nuevo usuario:
<div class="highlight"><pre>argocd account update-password \
  --account lara \
  --current-password **************** \
  --new-password *********
</pre></div></p>
<ul>
<li><strong>&ndash;account</strong>: nombre del nuevo usuario.</li>
<li><strong>&ndash;current-password</strong>: contraseña del usuario actual (en mi caso , será la contraseña de <code>admin</code>).</li>
<li><strong>&ndash;new-password</strong>: contraseña del nuevo usuario.</li>
</ul>
<p>Por lo tanto, cerramos la sesión y salimos del pod.
<div class="highlight"><pre>argocd logout www.argocd.org
</pre></div></p>
<p>Ya podemos deshabilitar el usuario <code>admin</code> mediante la siguiente declaración:
<div class="highlight"><pre>apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
  namespace: argocd
  labels:
    app.kubernetes.io/name: argocd-cm
    app.kubernetes.io/part-of: argocd
data:
  admin.enabled: &quot;false&quot;
</pre></div></p>
<p><br></p>
<h2 id="desarrollo-del-proyecto">Desarrollo del proyecto<a class="headerlink" href="#desarrollo-del-proyecto" title="Permanent link"></a></h2>
<p><br></p>
<h2 id="conclusiones-y-propuestas-adicionales-para-el-proyecto">Conclusiones y propuestas adicionales para el proyecto<a class="headerlink" href="#conclusiones-y-propuestas-adicionales-para-el-proyecto" title="Permanent link"></a></h2>
<p><br></p>
<h2 id="dificultades-encontradas-en-el-proyecto">Dificultades encontradas en el proyecto<a class="headerlink" href="#dificultades-encontradas-en-el-proyecto" title="Permanent link"></a></h2>
<p><br></p>
<h2 id="bibliografia">Bibliografía<a class="headerlink" href="#bibliografia" title="Permanent link"></a></h2>
<p>AnAr Solutions. (2021, 11 noviembre). Compare Infrastructure as Code - IaC vs Gitops. AnAr Solutions Pvt. Ltd. Recuperado 16 de marzo de 2022, de <a href="https://anarsolutions.com/iac-vs-gitops/">https://anarsolutions.com/iac-vs-gitops/</a></p>
<p>Andrada Prieto, J. (s. f.). ¿Qué es GITOPS? Viewnext. Recuperado 15 de marzo de 2022, de <a href="https://www.viewnext.com/que-es-gitops/">https://www.viewnext.com/que-es-gitops/</a></p>
<p>ArgoCD. (s. f.). Ingress Configuration - Argo CD - Declarative GitOps CD for Kubernetes. Argo CD. Recuperado 11 de abril de 2022, de <a href="https://argo-cd.readthedocs.io/en/stable/operator-manual/ingress/">https://argo-cd.readthedocs.io/en/stable/operator-manual/ingress/</a></p>
<p>argoproj-labs. (2022, 7 abril). GitHub - argoproj-labs/argocd-autopilot: Argo-CD Autopilot. GitHub. Recuperado 11 de abril de 2022, de <a class="magiclink magiclink-github magiclink-repository" href="https://github.com/argoproj-labs/argocd-autopilot" title="GitHub Repository: argoproj-labs/argocd-autopilot">argoproj-labs/argocd-autopilot</a></p>
<p>Dubey, A. (2022, 20 enero). All About ArgoCD, A Beginner’s Guide. DEV Community. Recuperado 2 de abril de 2022, de <a href="https://dev.to/abhinavd26/all-about-argocd-a-beginners-guide-33c9Jerez">https://dev.to/abhinavd26/all-about-argocd-a-beginners-guide-33c9Jerez</a>, Á. G. (2020, 29 mayo).</p>
<p>GitHub. (s. f.). Crear un token de acceso personal. Github Docs. Recuperado 11 de abril de 2022, de <a href="https://docs.github.com/es/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token">https://docs.github.com/es/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token</a></p>
<p>Iesgn. (2022, 9 marzo). GitHub - iesgn/curso_kubernetes_cep. GitHub. Recuperado 11 de abril de 2022, de <a class="magiclink magiclink-github magiclink-repository" href="https://github.com/iesgn/curso_kubernetes_cep" title="GitHub Repository: iesgn/curso_kubernetes_cep">iesgn/curso_kubernetes_cep</a></p>
<p>Implementando GitOps con ArgoCD. Adictos al trabajo. Recuperado 2 de abril de 2022, de <a href="https://www.adictosaltrabajo.com/2020/05/25/implementando-gitops-con-argocd/">https://www.adictosaltrabajo.com/2020/05/25/implementando-gitops-con-argocd/</a></p>
<p>Lingeswaran, R. (2021, 26 junio). GitOps vs Infrastructure as Code. UnixArena. Recuperado 15 de marzo de 2022, de <a href="https://www.unixarena.com/2021/06/gitops-vs-infrastructure-as-code.html/">https://www.unixarena.com/2021/06/gitops-vs-infrastructure-as-code.html/</a></p>
<p>Weaveworks. (s. f.). GitOps what you need to know. Recuperado 15 de marzo de 2022, de <a href="https://www.weave.works/technologies/gitops/">https://www.weave.works/technologies/gitops/</a></p>
<p>Weaveworks. (2022, 8 marzo). The Evolution of Configuration Management: IaC vs GitOps. Recuperado 16 de marzo de 2022, de <a href="https://www.weave.works/blog/evolution-configuration-management-iac-vs-gitops">https://www.weave.works/blog/evolution-configuration-management-iac-vs-gitops</a></p></article></body></html>